var GUI=function(){var j=this;var m=document.getElementsByTagName("head")[0],b=document.createElement("style"),i="#guidat{color:#fff;position:fixed;width:280px;z-index:200;opacity:.97;top:0;left:100%;margin-left:-300px;background-color:#fff;-webkit-box-shadow:0 0 10px rgba(0,0,0,0.3);-moz-box-shadow:0 0 10px rgba(0,0,0,0.3);box-shadow:0 0 10px rgba(0,0,0,0.3)}#guidat,#guidat input{font:9.5px Lucida Grande,sans-serif}#guidat-controllers{height:300px;overflow-y:auto;overflow-x:hidden;background-color:rgba(0,0,0,0.1);-moz-transition:height .2s ease-out;-webkit-transition:height .2s ease-out;transition:height .2s ease-out}#guidat-toggle{text-decoration:none;cursor:pointer;color:#fff;background-color:#222;text-align:center;display:block;padding:5px}#guidat-toggle:hover{background-color:#000}.guidat-controller{padding:3px;height:25px;clear:left;border-bottom:1px solid #222;background-color:#111}.guidat-controller,.guidat-controller input,.guidat-slider-bg,.guidat-slider-fg{-moz-transition:background-color .15s linear;-webkit-transition:background-color .15s linear;transition:background-color .15s linear}.guidat-controller.boolean:hover,.guidat-controller.function:hover{background-color:#000}.guidat-controller input{float:right;outline:none;border:0;padding:4px;margin-top:2px;background-color:#222}.guidat-controller input:hover{background-color:#444}.guidat-controller input:focus{background-color:#555}.guidat-controller.number{border-left:5px solid #00aeff}.guidat-controller.string{border-left:5px solid #1ed36f}.guidat-controller.string input{border:0;color:#1ed36f;margin-right:2px;width:148px}.guidat-controller.boolean{border-left:5px solid #54396e}.guidat-controller.function{border-left:5px solid #e61d5f}.guidat-controller.number input[type=text]{width:35px;margin-left:5px;margin-right:2px;color:#00aeff}#guidat .guidat-controller.boolean input{margin-top:6px;margin-right:2px;font-size:20px}.guidat-controller:last-child{border-bottom:none;-webkit-box-shadow:0 1px 3px rgba(0,0,0,0.5);-moz-box-shadow:0 1px 3px rgba(0,0,0,0.5);box-shadow:0 1px 3px rgba(0,0,0,0.5)}.guidat-propertyname{padding:5px;padding-top:7px;cursor:default;display:inline-block}.guidat-slider-bg:hover,.guidat-slider-bg.active{background-color:#444}.guidat-slider-bg:hover .guidat-slider-fg,.guidat-slider-bg.active .guidat-slider-fg{background-color:#52c8ff}.guidat-slider-bg{background-color:#222;cursor:ew-resize;width:40%;margin-top:2px;float:right;height:21px}.guidat-slider-fg{background-color:#00aeff;height:20px}";b.type="text/css";b.innerHTML=i;m.appendChild(b);var c=[];var h=[];var d=true;var l;var j=this,g=false,c=[],f=[];this.domElement=document.createElement("div");this.domElement.setAttribute("id","guidat");controllerContainer=document.createElement("div");controllerContainer.setAttribute("id","guidat-controllers");controllerContainer.style.height="0px";toggleButton=document.createElement("a");toggleButton.setAttribute("id","guidat-toggle");toggleButton.setAttribute("href","#");toggleButton.innerHTML="Show Controls";toggleButton.addEventListener("click",function(q){j.toggle();q.preventDefault()},false);this.domElement.appendChild(controllerContainer);this.domElement.appendChild(toggleButton);this.autoListenIntervalTime=1000/60;var a=function(){l=setInterval(function(){j.listen()},this.autoListenIntervalTime)};this.__defineSetter__("autoListen",function(q){d=q;if(!d){clearInterval(l)}else{if(h.length>0){a()}}});this.__defineGetter__("autoListen",function(q){return d});this.listenTo=function(q){if(h.length==0){a()}h.push(q)};this.unlistenTo=function(q){};this.listen=function(s){var q=s||h;for(var r in q){q[r].updateDisplay()}};this.listenAll=function(){this.listen(c)};this.autoListen=true;var n={number:NumberController,string:StringController,"boolean":BooleanController,"function":FunctionController};var e=function(r,q){for(var s in c){if(c[s].object==r&&c[s].propertyName==q){return true}}return false};var k=function(q){if(typeof console.log=="function"){console.error("[GUI ERROR] "+q)}};var p=function(r,q){function s(){return r.apply(this,q)}s.prototype=r.prototype;return new s()};this.add=function(){var u=arguments[0];var q=arguments[1];if(e(u,q)){k('Controller for "'+q+'" already added.');return}var x=u[q];if(x==undefined){k(u+' either has no property "'+q+'", or the property is inaccessible.');return}var w=typeof x;var v=n[w];if(v==undefined){k('Cannot create controller for data type "'+w+'"');return}var t=[j];for(var s=0;s<arguments.length;s++){t.push(arguments[s])}var r=p(v,t);if(!r){k('Error creating controller for "'+q+'".');return}controllerContainer.appendChild(r.domElement);c.push(r);return r};var o={number:NumberController,string:StringController,"boolean":BooleanController,"function":FunctionController};var e=function(r,q){for(var s in c){if(c[s].object==r&&c[s].propertyName==q){return true}}return false};var k=function(q){if(typeof console.log=="function"){console.error("[GUI ERROR] "+q)}};var p=function(r,q){function s(){return r.apply(this,q)}s.prototype=r.prototype;return new s()};this.toggle=function(){g?this.hide():this.show()};this.show=function(){controllerContainer.style.height="300px";toggleButton.innerHTML="Hide Controls";g=true};this.hide=function(){controllerContainer.style.height="0px";toggleButton.innerHTML="Show Controls";g=false}};GUI.makeUnselectable=function(a){a.onselectstart=function(){return false};a.style.MozUserSelect="none";a.style.KhtmlUserSelect="none";a.unselectable="on"};GUI.makeSelectable=function(a){a.onselectstart=function(){};a.style.MozUserSelect="auto";a.style.KhtmlUserSelect="auto";a.unselectable="off"};GUI.map=function(a,d,b,e,c){var a=e+(c-e)*((a-d)/(b-d));if(a<e){a=e}else{if(a>c){a=c}}return a};var Slider=function(a,d,i,b,h){var d=d;var i=i;var b=b;var g=false;var e=this;var j,k;this.domElement=document.createElement("div");this.domElement.setAttribute("class","guidat-slider-bg");this.fg=document.createElement("div");this.fg.setAttribute("class","guidat-slider-fg");this.domElement.appendChild(this.fg);var f=function(l){var m=curtop=0;if(l.offsetParent){do{m+=l.offsetLeft;curtop+=l.offsetTop}while(l=l.offsetParent);return[m,curtop]}};this.__defineSetter__("value",function(m){var l=GUI.map(m,d,i,0,100);this.fg.style.width=l+"%"});var c=function(l){if(!g){return}var n=f(e.domElement);var m=GUI.map(l.pageX,n[0],n[0]+e.domElement.offsetWidth,d,i);m=Math.round(m/b)*b;a.setValue(m)};this.domElement.addEventListener("mousedown",function(l){g=true;j=k=l.pageX;e.domElement.setAttribute("class","guidat-slider-bg active");e.fg.setAttribute("class","guidat-slider-fg active");c(l)},false);document.addEventListener("mouseup",function(l){e.domElement.setAttribute("class","guidat-slider-bg");e.fg.setAttribute("class","guidat-slider-fg");g=false},false);document.addEventListener("mousemove",c,false);this.value=h};var Controller=function(){this.parent=arguments[0];this.object=arguments[1];this.propertyName=arguments[2];this.domElement=document.createElement("div");this.domElement.setAttribute("class","guidat-controller "+this.type);this.propertyNameElement=document.createElement("span");this.propertyNameElement.setAttribute("class","guidat-propertyname");this.name(this.propertyName);this.domElement.appendChild(this.propertyNameElement);GUI.makeUnselectable(this.domElement)};Controller.prototype.changeFunction=null;Controller.prototype.name=function(a){this.propertyNameElement.innerHTML=a;return this};Controller.prototype.listen=function(){this.parent.listenTo(this)};Controller.prototype.unlisten=function(){this.parent.unlistenTo(this)};Controller.prototype.setValue=function(a){this.object[this.propertyName]=a;if(this.changeFunction!=null){this.changeFunction.call(this,a)}this.updateDisplay();return this};Controller.prototype.getValue=function(){return this.object[this.propertyName]};Controller.prototype.updateDisplay=function(){};Controller.prototype.onChange=function(a){this.changeFunction=a;return this};var BooleanController=function(){this.type="boolean";Controller.apply(this,arguments);var b=this;var a=document.createElement("input");a.setAttribute("type","checkbox");this.domElement.addEventListener("click",function(c){a.checked=!a.checked;c.preventDefault();b.setValue(a.checked)},false);a.addEventListener("mouseup",function(c){a.checked=!a.checked},false);this.domElement.style.cursor="pointer";this.propertyNameElement.style.cursor="pointer";this.domElement.appendChild(a);this.updateDisplay=function(){a.checked=b.getValue()}};BooleanController.prototype=new Controller();BooleanController.prototype.constructor=BooleanController;var FunctionController=function(){this.type="function";var a=this;Controller.apply(this,arguments);this.domElement.addEventListener("click",function(){a.object[a.propertyName].call(a.object)},false);this.domElement.style.cursor="pointer";this.propertyNameElement.style.cursor="pointer"};FunctionController.prototype=new Controller();FunctionController.prototype.constructor=FunctionController;var NumberController=function(){this.type="number";Controller.apply(this,arguments);var f=this;var a=false;var g=false;var j=py=0;var e=arguments[3];var k=arguments[4];var d=arguments[5];if(!d){if(e!=undefined&&k!=undefined){d=(k-e)*0.01}else{d=1}}var c=document.createElement("input");c.setAttribute("id",this.propertyName);c.setAttribute("type","text");c.setAttribute("value",this.getValue());if(d){c.setAttribute("step",d)}this.domElement.appendChild(c);var b;if(e!=undefined&&k!=undefined){b=new Slider(this,e,k,d,this.getValue());this.domElement.appendChild(b.domElement)}c.addEventListener("blur",function(l){var m=parseFloat(this.value);if(!isNaN(m)){f.updateValue(m)}else{this.value=f.getValue()}},false);c.addEventListener("mousewheel",function(l){l.preventDefault();this.updateValue(f.getValue()+Math.abs(l.wheelDeltaY)/l.wheelDeltaY*d);return false},false);c.addEventListener("mousedown",function(l){py=j=l.pageY;g=true;document.addEventListener("mousemove",h,false)},false);document.addEventListener("mouseup",function(l){document.removeEventListener("mousemove",h,false);GUI.makeSelectable(f.parent.domElement);GUI.makeSelectable(c);if(g&&!a){c.focus();c.select()}a=false;g=false},false);var h=function(n){a=true;n.preventDefault();GUI.makeUnselectable(f.parent.domElement);GUI.makeUnselectable(c);py=j;j=n.pageY;var l=py-j;var m=f.getValue()+l*d;f.setValue(m);return false};var i=function(o,l){var m=Math.pow(10,l);return Math.round(o*m)/m};this.setValue=function(l){l=parseFloat(l);if(e!=undefined&&l<=e){l=e}else{if(k!=undefined&&l>=k){l=k}}return Controller.prototype.setValue.call(this,l)};this.updateDisplay=function(){c.value=i(f.getValue(),4);if(b){b.value=f.getValue()}}};NumberController.prototype=new Controller();NumberController.prototype.constructor=NumberController;var StringController=function(){this.type="string";var c=this;Controller.apply(this,arguments);var b=document.createElement("input");var a=this.getValue();b.setAttribute("value",a);b.setAttribute("spellcheck","false");this.domElement.addEventListener("mouseup",function(){b.focus();b.select()},false);b.addEventListener("keyup",function(){c.setValue(b.value)},false);this.updateDisplay=function(){b.value=c.getValue()};this.domElement.appendChild(b)};StringController.prototype=new Controller();StringController.prototype.constructor=StringController;